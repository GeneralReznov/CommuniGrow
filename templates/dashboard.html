{% extends "base.html" %}

{% block title %}Dashboard - Community Platform{% endblock %}

{% block content %}
<!-- Particle Background for Dashboard -->
<div id="particles-js" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>

<!-- Futuristic Dashboard Header -->
<section class="dashboard-hero">
    <div class="container">
        <div class="row align-items-center py-5">
            <div class="col-lg-8">
                <div class="dashboard-welcome" data-aos="fade-right">
                    <h1 class="display-4 fw-bold text-white mb-3">
                        Welcome to Your <span class="typing-text">Community Hub</span>
                    </h1>
                    <p class="lead text-white-50 mb-4">
                        Your personalized command center for climate action, skills development, 
                        food security, and health management.
                    </p>
                    <div class="quick-stats d-flex flex-wrap gap-4">
                        <div class="stat-item">
                            <div class="stat-value text-warning">Today</div>
                            <div class="stat-label">Active</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value text-success" id="weather-temp">Loading...</div>
                            <div class="stat-label">Weather</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value text-info">4</div>
                            <div class="stat-label">Modules</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 text-center">
                <button class="btn btn-futuristic pulse-glow" onclick="startDashboardTour()" data-aos="fade-left">
                    <i class="fas fa-play me-2"></i>Interactive Tour
                </button>
            </div>
        </div>
    </div>
</section>

<!-- Smart Overview Cards -->
<section class="dashboard-overview py-5">
    <div class="container">
        <div class="row g-4 mb-5">
            <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="100">
                <div class="smart-card climate-card">
                    <div class="card-icon">
                        <i class="fas fa-cloud-sun"></i>
                    </div>
                    <div class="card-content">
                        <h6>Climate Status</h6>
                        <div class="status-value" id="climate-status">Monitoring...</div>
                        <div class="status-change">+2Â°C from yesterday</div>
                    </div>
                    <div class="card-action">
                        <a href="{{ url_for('climate.alerts') }}" class="btn btn-sm btn-outline-light">
                            View Alerts <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="200">
                <div class="smart-card skills-card">
                    <div class="card-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <div class="card-content">
                        <h6>Job Opportunities</h6>
                        <div class="status-value">25+ Available</div>
                        <div class="status-change">5 new this week</div>
                    </div>
                    <div class="card-action">
                        <a href="{{ url_for('skills.jobs') }}" class="btn btn-sm btn-outline-light">
                            Browse Jobs <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="300">
                <div class="smart-card food-card">
                    <div class="card-icon">
                        <i class="fas fa-shopping-basket"></i>
                    </div>
                    <div class="card-content">
                        <h6>Fresh Marketplace</h6>
                        <div class="status-value">40+ Items</div>
                        <div class="status-change">10 added today</div>
                    </div>
                    <div class="card-action">
                        <a href="{{ url_for('food.marketplace') }}" class="btn btn-sm btn-outline-light">
                            Shop Now <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-3 col-md-6" data-aos="fade-up" data-aos-delay="400">
                <div class="smart-card health-card">
                    <div class="card-icon">
                        <i class="fas fa-heartbeat"></i>
                    </div>
                    <div class="card-content">
                        <h6>Health Services</h6>
                        <div class="status-value">12+ Nearby</div>
                        <div class="status-change">AI Chat Ready</div>
                    </div>
                    <div class="card-action">
                        <a href="{{ url_for('health.chatbot') }}" class="btn btn-sm btn-outline-light">
                            Ask AI <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Interactive Module Grid -->
<section class="module-grid-section py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold text-white" data-aos="fade-up">
                Platform Modules
            </h2>
            <p class="lead text-white-50" data-aos="fade-up" data-aos-delay="200">
                Explore our comprehensive suite of community empowerment tools
            </p>
        </div>
        
        <div class="row g-4">
            <!-- Climate Action Module -->
            <div class="col-lg-6" data-aos="fade-up" data-aos-delay="100">
                <div class="module-card-futuristic climate-module-card">
                    <div class="module-header">
                        <div class="module-icon-large">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div class="module-title">
                            <h3>Climate Action & Sustainability</h3>
                            <p>AI-powered climate alerts, sustainable practice guidance, and disaster preparedness</p>
                        </div>
                    </div>
                    
                    <div class="module-features">
                        <div class="feature-item">
                            <i class="fas fa-exclamation-triangle text-warning"></i>
                            <span>Real-time Weather Alerts</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-recycle text-success"></i>
                            <span>Sustainable Practices</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-solar-panel text-info"></i>
                            <span>Renewable Energy Guidance</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-wifi text-primary"></i>
                            <span>Environmental Sensors</span>
                        </div>
                    </div>
                    
                    <div class="module-actions">
                        <a href="{{ url_for('climate.index') }}" class="btn btn-futuristic">
                            <i class="fas fa-rocket me-2"></i>Explore Climate
                        </a>
                        <button class="btn btn-outline-light" onclick="speakModuleInfo('climate')">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Skills & Employment Module -->
            <div class="col-lg-6" data-aos="fade-up" data-aos-delay="200">
                <div class="module-card-futuristic skills-module-card">
                    <div class="module-header">
                        <div class="module-icon-large">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div class="module-title">
                            <h3>Skills & Employment</h3>
                            <p>AI job matching, microlearning, and community skill development</p>
                        </div>
                    </div>
                    
                    <div class="module-features">
                        <div class="feature-item">
                            <i class="fas fa-search text-info"></i>
                            <span>Smart Job Matching</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-book-open text-success"></i>
                            <span>Microlearning Modules</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-hands-helping text-warning"></i>
                            <span>Volunteer Opportunities</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-users text-primary"></i>
                            <span>Skill Sharing Network</span>
                        </div>
                    </div>
                    
                    <div class="module-actions">
                        <a href="{{ url_for('skills.index') }}" class="btn btn-futuristic">
                            <i class="fas fa-rocket me-2"></i>Develop Skills
                        </a>
                        <button class="btn btn-outline-light" onclick="speakModuleInfo('skills')">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Food & Nutrition Module -->
            <div class="col-lg-6" data-aos="fade-up" data-aos-delay="300">
                <div class="module-card-futuristic food-module-card">
                    <div class="module-header">
                        <div class="module-icon-large">
                            <i class="fas fa-apple-alt"></i>
                        </div>
                        <div class="module-title">
                            <h3>Food & Nutrition Security</h3>
                            <p>Community marketplace, nutrition AI, and food sharing networks</p>
                        </div>
                    </div>
                    
                    <div class="module-features">
                        <div class="feature-item">
                            <i class="fas fa-store text-success"></i>
                            <span>Local Marketplace</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-brain text-info"></i>
                            <span>AI Nutrition Planning</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-share-alt text-warning"></i>
                            <span>Food Sharing Network</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-shield-alt text-primary"></i>
                            <span>Food Safety Guidance</span>
                        </div>
                    </div>
                    
                    <div class="module-actions">
                        <a href="{{ url_for('food.index') }}" class="btn btn-futuristic">
                            <i class="fas fa-rocket me-2"></i>Access Food
                        </a>
                        <button class="btn btn-outline-light" onclick="speakModuleInfo('food')">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Health & Well-being Module -->
            <div class="col-lg-6" data-aos="fade-up" data-aos-delay="400">
                <div class="module-card-futuristic health-module-card">
                    <div class="module-header">
                        <div class="module-icon-large">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <div class="module-title">
                            <h3>Health & Well-being</h3>
                            <p>AI health support, service mapping, and preventive care guidance</p>
                        </div>
                    </div>
                    
                    <div class="module-features">
                        <div class="feature-item">
                            <i class="fas fa-robot text-info"></i>
                            <span>AI Health Chatbot</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-map-marker-alt text-success"></i>
                            <span>Interactive Service Map</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-clipboard-check text-warning"></i>
                            <span>Health Assessments</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-baby text-danger"></i>
                            <span>Maternal Health Support</span>
                        </div>
                    </div>
                    
                    <div class="module-actions">
                        <a href="{{ url_for('health.index') }}" class="btn btn-futuristic">
                            <i class="fas fa-rocket me-2"></i>Get Support
                        </a>
                        <button class="btn btn-outline-light" onclick="speakModuleInfo('health')">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Quick Actions Panel -->
<section class="quick-actions-section py-5">
    <div class="container">
        <div class="quick-actions-panel" data-aos="fade-up">
            <div class="panel-header">
                <h4 class="text-white mb-0">
                    <i class="fas fa-bolt me-2"></i>Quick Actions
                </h4>
                <p class="text-white-50 mb-0">Instant access to frequently used features</p>
            </div>
            
            <div class="action-grid">
                <button class="action-btn climate-action" onclick="checkWeatherAlert()">
                    <i class="fas fa-cloud-sun"></i>
                    <span>Weather Check</span>
                </button>
                
                <button class="action-btn health-action" onclick="startHealthChat()">
                    <i class="fas fa-comments"></i>
                    <span>Health Chat</span>
                </button>
                
                <button class="action-btn food-action" onclick="viewMarketplace()">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Marketplace</span>
                </button>
                
                <button class="action-btn skills-action" onclick="findJobs()">
                    <i class="fas fa-search"></i>
                    <span>Find Jobs</span>
                </button>
                
                <button class="action-btn emergency-action" onclick="showEmergencyInfo()">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Emergency</span>
                </button>
                
                <button class="action-btn voice-action" onclick="startVoiceCommand()">
                    <i class="fas fa-microphone"></i>
                    <span>Voice Control</span>
                </button>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
// Enhanced Dashboard Functionality
document.addEventListener('DOMContentLoaded', function() {
    initDashboard();
    loadDashboardData();
});

function initDashboard() {
    // Initialize particle background for dashboard
    if (document.getElementById('particles-js')) {
        particlesJS('particles-js', {
            "particles": {
                "number": {
                    "value": 50,
                    "density": {
                        "enable": true,
                        "value_area": 800
                    }
                },
                "color": {
                    "value": "#ffffff"
                },
                "shape": {
                    "type": "circle"
                },
                "opacity": {
                    "value": 0.3,
                    "random": false
                },
                "size": {
                    "value": 2,
                    "random": true
                },
                "line_linked": {
                    "enable": true,
                    "distance": 150,
                    "color": "#ffffff",
                    "opacity": 0.2,
                    "width": 1
                },
                "move": {
                    "enable": true,
                    "speed": 1,
                    "direction": "none",
                    "random": false,
                    "straight": false,
                    "out_mode": "out",
                    "bounce": false
                }
            },
            "interactivity": {
                "detect_on": "canvas",
                "events": {
                    "onhover": {
                        "enable": true,
                        "mode": "repulse"
                    },
                    "onclick": {
                        "enable": true,
                        "mode": "push"
                    },
                    "resize": true
                }
            },
            "retina_detect": true
        });
    }
}

function loadDashboardData() {
    // Simulate loading weather data
    setTimeout(() => {
        document.getElementById('weather-temp').textContent = '22Â°C';
        document.getElementById('climate-status').textContent = 'Fair Weather';
    }, 1000);
}

function startDashboardTour() {
    const tourText = `Welcome to your futuristic community dashboard! This is your personalized command center for community empowerment.
    
    The dashboard features four main modules: Climate Action provides weather alerts and sustainability guidance. Skills and Employment offers AI-powered job matching and learning. Food and Nutrition connects you to local marketplace and nutrition support. Health and Well-being delivers AI chatbot and medical services.
    
    Use the smart overview cards to quickly check status updates. The quick actions panel provides instant access to frequently used features. Everything is voice-enabled - try saying "show climate module" or "check weather" to navigate.
    
    Which module would you like to explore first?`;
    
    speakText(tourText);
}

function speakModuleInfo(module) {
    const moduleInfo = {
        climate: "Climate Action module provides real-time weather alerts, sustainable practice guidance, renewable energy information, and environmental sensor data to help you prepare for climate challenges.",
        skills: "Skills and Employment module offers AI-powered job matching, microlearning opportunities, volunteer work connections, and community skill sharing to boost your career prospects.",
        food: "Food and Nutrition module includes local marketplace access, AI nutrition planning, food sharing networks, and food safety guidance for community food security.",
        health: "Health and Well-being module provides AI health chatbot, interactive service mapping, health assessments, and maternal health support for comprehensive healthcare access."
    };
    
    speakText(moduleInfo[module] || "Module information not available.");
}

// Quick Action Functions
function checkWeatherAlert() {
    speakText('Checking current weather conditions...');
    setTimeout(() => {
        window.location.href = "{{ url_for('climate.alerts') }}";
    }, 1500);
}

function startHealthChat() {
    speakText('Opening AI health chatbot...');
    setTimeout(() => {
        window.location.href = "{{ url_for('health.chatbot') }}";
    }, 1500);
}

function viewMarketplace() {
    speakText('Opening community marketplace...');
    setTimeout(() => {
        window.location.href = "{{ url_for('food.marketplace') }}";
    }, 1500);
}

function findJobs() {
    speakText('Searching available job opportunities...');
    setTimeout(() => {
        window.location.href = "{{ url_for('skills.jobs') }}";
    }, 1500);
}

function showEmergencyInfo() {
    speakText('Displaying emergency information...');
    const emergencyModal = new bootstrap.Modal(document.getElementById('emergencyModal'));
    emergencyModal.show();
}

function startVoiceCommand() {
    speakText('Voice command ready. Please speak your request...');
    if (window.voiceSystem && window.voiceSystem.startListening) {
        window.voiceSystem.startListening();
    }
}

// Enhanced Voice Commands for Dashboard
function handleDashboardVoiceCommand(command) {
    const lowerCommand = command.toLowerCase();
    
    if (lowerCommand.includes('climate') || lowerCommand.includes('weather')) {
        window.location.href = "{{ url_for('climate.index') }}";
    } else if (lowerCommand.includes('skills') || lowerCommand.includes('jobs') || lowerCommand.includes('employment')) {
        window.location.href = "{{ url_for('skills.index') }}";
    } else if (lowerCommand.includes('food') || lowerCommand.includes('nutrition') || lowerCommand.includes('marketplace')) {
        window.location.href = "{{ url_for('food.index') }}";
    } else if (lowerCommand.includes('health') || lowerCommand.includes('medical') || lowerCommand.includes('doctor')) {
        window.location.href = "{{ url_for('health.index') }}";
    } else if (lowerCommand.includes('emergency')) {
        showEmergencyInfo();
    } else if (lowerCommand.includes('help') || lowerCommand.includes('tour')) {
        startDashboardTour();
    } else if (lowerCommand.includes('weather check')) {
        checkWeatherAlert();
    } else if (lowerCommand.includes('health chat')) {
        startHealthChat();
    }
}

// Override global voice handler for dashboard
if (typeof window.globalVoiceHandler !== 'undefined') {
    window.globalVoiceHandler = handleDashboardVoiceCommand;
}
</script>

<style>
/* Dashboard-specific styles */
.dashboard-hero {
    padding: 2rem 0;
    position: relative;
    z-index: 2;
}

.stat-item {
    text-align: center;
}

.stat-value {
    font-size: 1.5rem;
    font-weight: bold;
}

.stat-label {
    font-size: 0.875rem;
    color: rgba(255, 255, 255, 0.7);
}

.smart-card {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 20px;
    padding: 1.5rem;
    transition: all 0.3s ease;
    height: 100%;
    position: relative;
    overflow: hidden;
}

.smart-card:hover {
    transform: translateY(-5px);
    background: rgba(255, 255, 255, 0.15);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
}

.smart-card .card-icon {
    font-size: 2rem;
    margin-bottom: 1rem;
    color: white;
}

.smart-card h6 {
    color: white;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.status-value {
    font-size: 1.2rem;
    font-weight: bold;
    color: white;
    margin-bottom: 0.25rem;
}

.status-change {
    font-size: 0.875rem;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 1rem;
}

.module-card-futuristic {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 25px;
    padding: 2rem;
    transition: all 0.3s ease;
    height: 100%;
    position: relative;
    overflow: hidden;
}

.module-card-futuristic:hover {
    transform: translateY(-10px);
    background: rgba(255, 255, 255, 0.15);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
}

.module-header {
    display: flex;
    align-items: flex-start;
    margin-bottom: 1.5rem;
}

.module-icon-large {
    font-size: 3rem;
    margin-right: 1rem;
    color: white;
    flex-shrink: 0;
}

.module-title h3 {
    color: white;
    font-weight: bold;
    margin-bottom: 0.5rem;
    font-size: 1.5rem;
}

.module-title p {
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 0;
    font-size: 0.95rem;
}

.module-features {
    margin-bottom: 2rem;
}

.feature-item {
    display: flex;
    align-items: center;
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 0.75rem;
    font-size: 0.95rem;
}

.feature-item i {
    margin-right: 0.75rem;
    width: 20px;
}

.module-actions {
    display: flex;
    gap: 1rem;
    align-items: center;
}

.quick-actions-panel {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 25px;
    padding: 2rem;
}

.panel-header {
    text-align: center;
    margin-bottom: 2rem;
}

.action-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 1rem;
}

.action-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    padding: 1.5rem 1rem;
    color: white;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
}

.action-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    color: white;
}

.action-btn i {
    font-size: 1.5rem;
}

.action-btn span {
    font-size: 0.875rem;
    font-weight: 500;
}

/* Module-specific color accents */
.climate-card:hover, .climate-module-card:hover, .climate-action:hover {
    box-shadow: 0 20px 40px rgba(40, 167, 69, 0.3);
}

.skills-card:hover, .skills-module-card:hover, .skills-action:hover {
    box-shadow: 0 20px 40px rgba(0, 123, 255, 0.3);
}

.food-card:hover, .food-module-card:hover, .food-action:hover {
    box-shadow: 0 20px 40px rgba(255, 193, 7, 0.3);
}

.health-card:hover, .health-module-card:hover, .health-action:hover {
    box-shadow: 0 20px 40px rgba(220, 53, 69, 0.3);
}

.emergency-action:hover {
    box-shadow: 0 20px 40px rgba(255, 108, 49, 0.3);
}

.voice-action:hover {
    box-shadow: 0 20px 40px rgba(108, 117, 125, 0.3);
}

@media (max-width: 768px) {
    .action-grid {
        grid-template-columns: repeat(3, 1fr);
    }
    
    .module-header {
        flex-direction: column;
        text-align: center;
    }
    
    .module-icon-large {
        margin-right: 0;
        margin-bottom: 1rem;
    }
}
</style>
{% endblock %}